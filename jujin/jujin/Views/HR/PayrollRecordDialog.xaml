<?xml version="1.0" encoding="utf-8"?>
<Window x:Class="jujin.Views.HR.PayrollRecordDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
        Title="급여 기록" Height="900" Width="1200"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize">
    <Grid Background="#FFFFFF">
        <Border BorderBrush="#BDC3C7" BorderThickness="2" CornerRadius="5" Margin="20">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- 제목 -->
                <TextBlock x:Name="TitleText" Grid.Row="0" Text="급여 기록" FontSize="24" FontWeight="Bold" 
                           Foreground="#2C3E50" Margin="20,20,20,10" HorizontalAlignment="Center"/>

                <!-- 년도 선택 -->
                <Grid Grid.Row="1" Margin="20,0,20,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0" Text="조회 년도:" VerticalAlignment="Center" 
                               Margin="0,0,10,0" FontWeight="SemiBold"/>

                    <Button Grid.Column="1" Content="◀" Width="40" Height="35" 
                            Background="#95A5A6" Foreground="White" BorderThickness="0"
                            Click="PreviousYearButton_Click" ToolTip="이전 년도"/>

                    <TextBlock x:Name="CurrentYearText" Grid.Column="2" Text="2025년" 
                               VerticalAlignment="Center" Margin="15,0" FontSize="18" 
                               FontWeight="Bold" Foreground="#2C3E50"/>

                    <Button Grid.Column="3" Content="▶" Width="40" Height="35" 
                            Background="#95A5A6" Foreground="White" BorderThickness="0"
                            Click="NextYearButton_Click" ToolTip="다음 년도"/>
                </Grid>

                <!-- 통계 영역 -->
                <Grid Grid.Row="2" Margin="20,0,20,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- 월별 통계 테이블 -->
                    <Border Grid.Column="0" BorderBrush="#BDC3C7" BorderThickness="1" CornerRadius="5" Margin="0,0,10,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- 테이블 제목 -->
                            <TextBlock x:Name="TableTitleText" Grid.Row="0" Text="2025년 통계" 
                                       FontSize="18" FontWeight="Bold" Foreground="#2C3E50" 
                                       Margin="20,20,20,10" HorizontalAlignment="Center"/>

                            <!-- 데이터 그리드 -->
                            <DataGrid x:Name="PayrollDataGrid" Grid.Row="1" Margin="20,0,20,20"
                                      AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False"
                                      IsReadOnly="True" HeadersVisibility="Column" GridLinesVisibility="Horizontal"
                                      Background="White" BorderThickness="0">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="월" Binding="{Binding Month}" Width="60" FontWeight="Bold"/>
                                    <DataGridTextColumn Header="기본급" Binding="{Binding GrossPay, StringFormat='{}{0:N0}원'}" Width="120"/>
                                    <DataGridTextColumn Header="수당" Binding="{Binding Allowance, StringFormat='{}{0:N0}원'}" Width="120"/>
                                    <DataGridTextColumn Header="공제액" Binding="{Binding Deductions, StringFormat='{}{0:N0}원'}" Width="120"/>
                                    <DataGridTextColumn Header="실지급액" Binding="{Binding NetPay, StringFormat='{}{0:N0}원'}" Width="120"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </Border>

                    <!-- 총합 비율 차트 -->
                    <Border Grid.Column="1" BorderBrush="#BDC3C7" BorderThickness="1" CornerRadius="5" Margin="10,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- 차트 제목 -->
                            <TextBlock Text="총합 비율 차트" 
                                       FontSize="18" FontWeight="Bold" Foreground="#2C3E50" 
                                       Margin="20,20,20,10" HorizontalAlignment="Center"/>

                            <!-- 비율 차트 -->
                            <lvc:CartesianChart x:Name="RatioChart" Grid.Row="1" Margin="20,0,20,55"
                                                Series="{Binding RatioSeriesCollection}"
                                                LegendLocation="None">
                                <lvc:CartesianChart.AxisX>
                                    <lvc:Axis ShowLabels="False" Separator="{x:Static lvc:DefaultAxes.CleanSeparator}"></lvc:Axis>
                                </lvc:CartesianChart.AxisX>
                                <lvc:CartesianChart.AxisY>
                                    <lvc:Axis Title="금액 (원)" LabelFormatter="{Binding RatioYFormatter}" FontSize="12"></lvc:Axis>
                                </lvc:CartesianChart.AxisY>
                            </lvc:CartesianChart>

                            <!-- 명시적 라벨 표시 -->
                            <Grid Grid.Row="1" Margin="102,0,20,20" VerticalAlignment="Bottom" Height="30">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Column="0" Text="기본급" HorizontalAlignment="Center" 
                                           VerticalAlignment="Center" FontSize="12" FontWeight="Bold" 
                                           Foreground="#2C3E50"/>
                                <TextBlock Grid.Column="1" Text="수당" HorizontalAlignment="Center" 
                                           VerticalAlignment="Center" FontSize="12" FontWeight="Bold" 
                                           Foreground="#2C3E50"/>
                                <TextBlock Grid.Column="2" Text="공제액" HorizontalAlignment="Center" 
                                           VerticalAlignment="Center" FontSize="12" FontWeight="Bold" 
                                           Foreground="#2C3E50"/>
                                <TextBlock Grid.Column="3" Text="실지급액" HorizontalAlignment="Center" 
                                           VerticalAlignment="Center" FontSize="12" FontWeight="Bold" 
                                           Foreground="#2C3E50"/>
                            </Grid>
                        </Grid>
                    </Border>
                </Grid>

                <!-- 버튼들 -->
                <Grid Grid.Row="3" Margin="20,0,20,20">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0" Content="새로고침" Height="40"
                            Background="#3498DB" Foreground="White" BorderThickness="0"
                            Click="RefreshButton_Click"/>

                    <Button Grid.Column="2" Content="닫기" Height="40"
                            Background="#95A5A6" Foreground="White" BorderThickness="0"
                            Click="CloseButton_Click"/>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</Window>
